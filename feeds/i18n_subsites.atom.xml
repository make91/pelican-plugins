<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>smartass101's Pelican plugins</title><link href="http://smartass101.github.io/pelican-plugins/" rel="alternate"></link><link href="http://smartass101.github.io/pelican-plugins/feeds/i18n_subsites.atom.xml" rel="self"></link><id>http://smartass101.github.io/pelican-plugins/</id><updated>2014-02-05T00:00:00+01:00</updated><entry><title>i18n_subsites plugin released</title><link href="http://smartass101.github.io/pelican-plugins/i18n_subsites-plugin-released.html" rel="alternate"></link><updated>2014-02-05T00:00:00+01:00</updated><author><name>Ondřej Grover</name></author><id>tag:smartass101.github.io,2014-02-05:pelican-plugins/i18n_subsites-plugin-released.html</id><summary type="html">&lt;p&gt;Pelican supports article and page translations &lt;a class="reference external" href="https://github.com/getpelican/pelican/blob/master/docs/changelog.rst#26-2011-03-08"&gt;since version 2.6&lt;/a&gt;.
However, this functionality does not include translations of themes or the site name, something many have asked for.&lt;/p&gt;
&lt;p&gt;The new i18n_subsites plugin makes it simple to:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;override settings for each language, e.g. &lt;tt class="docutils literal"&gt;SITENAME&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;MENUITEMS&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;translate and localize themes using &lt;tt class="docutils literal"&gt;jinja2.ext.i18n&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;automatically create translated subsites like &lt;a class="reference external" href="http://example.com/fr/"&gt;http://example.com/fr/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is available in the &lt;a class="reference external" href="https://github.com/getpelican/pelican-plugins/tree/master/i18n_subsites"&gt;Pelican plugin repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A &lt;a class="reference external" href="http://smartass101.github.io/pelican-plugins/"&gt;demo site&lt;/a&gt; has been put up to showcase the plugin.
You can use the &lt;a class="reference external" href="https://github.com/smartass101/pelican-plugins/tree/gh-pages_source"&gt;sources for the site&lt;/a&gt; as a reference for using the plugin in your own site.&lt;/p&gt;
&lt;p&gt;Althoug this plugin has been tested, it is quite possible that you will find some bugs or incovenient behavior as it is very new. Do not hesitate to file an issue!&lt;/p&gt;
&lt;p&gt;Finally, I would like to thank the Pelican developers for implementing and designing Pelican so well that making this plugin was straightforward, fast and fun.&lt;/p&gt;
</summary></entry><entry><title>Implementing language buttons</title><link href="http://smartass101.github.io/pelican-plugins/implementing-lang-buttons.html" rel="alternate"></link><updated>2014-02-03T00:00:00+01:00</updated><author><name>smartass101</name></author><id>tag:smartass101.github.io,2014-02-03:pelican-plugins/implementing-lang-buttons.html</id><summary type="html">&lt;p&gt;Each article with translations has translations links, but that's the only way to switch between language subsites.&lt;/p&gt;
&lt;p&gt;I wanted to make it simple to switch between the language subsites on all pages, so I decided to add language buttons to the top menu bar.&lt;/p&gt;
&lt;p&gt;For this purpose I used the &lt;tt class="docutils literal"&gt;extra_siteurls&lt;/tt&gt; dictionary exported by the &lt;tt class="docutils literal"&gt;i18n_subsites&lt;/tt&gt; plugin into the template context. This dictionary maps the language code to the SITEURL of the respective subsite. But I wanted the language button to show the names of the language codes, not just the language codes.&lt;/p&gt;
&lt;p&gt;Perhaps I should have added support for putting the names in &lt;tt class="docutils literal"&gt;I18N_SUBSITES&lt;/tt&gt; and exporting the names in &lt;tt class="docutils literal"&gt;extra_siteurls&lt;/tt&gt; too? No, I want to keep the &lt;tt class="docutils literal"&gt;i18n_subsites&lt;/tt&gt; plugin as simple as possible and let people add features onto it. IMHO that is better than making many assumptions about what people may want, because you cannot please everyone, e.g. somebody would rather put there flags &lt;a class="footnote-reference" href="#flags" id="id1"&gt;[1]&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So, the (IMHO) simplest way to support this is to make a simple jinja2 filter that translates the language code to the language name via a dictionary. Here is the relevant part of my pelicanconf.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;languages_lookup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
             &lt;span class="s"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;English&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="s"&gt;&amp;#39;cz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Čeština&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;lookup_lang_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lang_code&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;languages_lookup&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;lang_code&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;JINJA_FILTERS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
             &lt;span class="s"&gt;&amp;#39;lookup_lang_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;lookup_lang_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now it's just a matter of using the filter in the &lt;tt class="docutils literal"&gt;base.html&lt;/tt&gt; template at the beginning of the navbar&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;&amp;lt;!-- SNIP --&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;nav&amp;gt;&amp;lt;ul&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;extra_siteurls&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;url&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;extra_siteurls.items&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;li&amp;gt;&amp;lt;a href=&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;url&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nf"&gt;lookup_lang_name&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;!-- separator --&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;li style=&amp;quot;background-color: white; padding: 5px;&amp;quot;&amp;gt;&amp;amp;nbsp&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;title&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;link&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;MENUITEMS&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;!-- SNIP --&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="different-design"&gt;
&lt;h2&gt;Different design&lt;/h2&gt;
&lt;p&gt;Later I decided that I want to show the active language in the navbar too
.
So, I needed a list of all the languages the site supports, so I used the &lt;em&gt;I18N_SUBSITES&lt;/em&gt; dictionary as it is available in templates (because it is an all-caps config setting) and extracted the list of languages as &lt;tt class="docutils literal"&gt;I18N_SUBSITES.keys()&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Here is the slightly modified template&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="x"&gt;&amp;lt;!-- SNIP --&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;nav&amp;gt;&amp;lt;ul&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;extra_siteurls&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="nv"&gt;I18N_SUBSITES&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;lang&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="nv"&gt;main_lang&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;I18N_SUBSITES.keys&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nf"&gt;list&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;li&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nv"&gt;DEFAULT_LANG&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt; class=&amp;quot;active&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&amp;gt;&amp;lt;a href=&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;extra_siteurls.get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;SITEURL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nf"&gt;lookup_lang_name&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;!-- separator --&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;li style=&amp;quot;background-color: white; padding: 5px;&amp;quot;&amp;gt;&amp;amp;nbsp&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;title&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nv"&gt;link&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;MENUITEMS&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;!-- SNIP --&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What it does:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;get a list of all languages as the main language (&lt;tt class="docutils literal"&gt;main_lang&lt;/tt&gt; exported by the &lt;tt class="docutils literal"&gt;i18n_subsites&lt;/tt&gt; plugin) and the subsites languages. The list filter is needed as &lt;tt class="docutils literal"&gt;keys()&lt;/tt&gt; does not return a list and the list concatenation (&lt;tt class="docutils literal"&gt;+&lt;/tt&gt;) would not work&lt;/li&gt;
&lt;li&gt;for each lang it makes link and makes it active if it is the &lt;em&gt;DEFAULT_LANG&lt;/em&gt; of the currently rendered subsite&lt;/li&gt;
&lt;li&gt;gets the url for the (sub)site. If the lang is not ins &lt;tt class="docutils literal"&gt;extra_siteurls*&lt;/tt&gt;, it must be the current &lt;em&gt;DEFAULT_LANG&lt;/em&gt;, so use the current &lt;em&gt;SITEURL&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;looks up the language name&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can see the result for yourself at the top of the page.&lt;/p&gt;
&lt;p&gt;Now that I look at the above snippet, I'm not sure if &lt;tt class="docutils literal"&gt;extra_siteurls&lt;/tt&gt; is that convenient. Perhaps something like &lt;tt class="docutils literal"&gt;lang_siteurls&lt;/tt&gt; dictionary for all languages would have been more convenient. Anyways, all the information is available in the context at the moment, if it bugs you too much, contact me and I'll improve it.&lt;/p&gt;
&lt;table class="docutils footnote" frame="void" id="flags" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;Although it may look nice, &lt;a class="reference external" href="http://www.w3.org/TR/i18n-html-tech-lang/#ri20040808.173208643"&gt;w3 discourages it&lt;/a&gt;.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</summary></entry><entry><title>A translated article</title><link href="http://smartass101.github.io/pelican-plugins/translated-article.html" rel="alternate"></link><updated>2014-02-02T00:00:00+01:00</updated><author><name>smartass101</name></author><id>tag:smartass101.github.io,2014-02-02:pelican-plugins/translated-article.html</id><summary type="html">&lt;p&gt;This article has a translation, the translation link will take you to it.&lt;/p&gt;
&lt;p&gt;Notice that the translation can have a different tag, so even tags can be translated.&lt;/p&gt;
&lt;p&gt;As described in the &lt;a class="reference external" href="http://docs.getpelican.com/en/3.3.0/getting_started.html#translations"&gt;Pelican translations documentation&lt;/a&gt;, an article is considered a translation of a different article if&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;it has the same &lt;tt class="docutils literal"&gt;slug&lt;/tt&gt; metadata&lt;/li&gt;
&lt;li&gt;has a different &lt;tt class="docutils literal"&gt;lang&lt;/tt&gt; metadata&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;If you want the translation to have a different filename and url than the slug in the original language, use the &lt;tt class="docutils literal"&gt;save_as&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;url&lt;/tt&gt; metadata as this translation link shows.&lt;/p&gt;
</summary><category term="example"></category></entry><entry><title>An untranslated article</title><link href="http://smartass101.github.io/pelican-plugins/untranslated-article.html" rel="alternate"></link><updated>2014-02-01T00:00:00+01:00</updated><author><name>smartass101</name></author><id>tag:smartass101.github.io,2014-02-01:pelican-plugins/untranslated-article.html</id><summary type="html">&lt;p&gt;This article has no translation, so you will find it as a &lt;a class="reference external" href="cz/drafts/untranslated-article.html"&gt;draft&lt;/a&gt; in the Czech subsite, because I have &lt;tt class="docutils literal"&gt;I18N_HIDE_UNTRANSLATED_CONTENT&lt;/tt&gt; as True (the default).&lt;/p&gt;
</summary><category term="example"></category></entry></feed>